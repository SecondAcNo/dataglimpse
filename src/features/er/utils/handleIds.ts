/**
 * colHandleIdL
 * -----------------------------------------------------------------------------
 * 指定したカラム名から「左側ハンドル用 ID」を生成する。
 *
 * フォーマット:
 *   "hL-{columnName}"
 *
 * 用途:
 * - ReactFlow のカスタムノードで、左側に配置するハンドル（入力側）を一意に識別。
 * - Edge 接続時の source/target 識別子として利用。
 *
 * 注意:
 * - columnName にスペースや記号が含まれる場合はそのまま埋め込まれるため、
 *   呼び出し元でエスケープや正規化する責務がある。
 */
export const colHandleIdL = (col: string): string => `hL-${col}`;

/**
 * colHandleIdR
 * -----------------------------------------------------------------------------
 * 指定したカラム名から「右側ハンドル用 ID」を生成する。
 *
 * フォーマット:
 *   "hR-{columnName}"
 *
 * 用途:
 * - ReactFlow のカスタムノードで、右側に配置するハンドル（出力側）を一意に識別。
 * - 主に「外部参照される列（FK）」などを表現するのに用いる。
 */
export const colHandleIdR = (col: string): string => `hR-${col}`;

/**
 * sideFromHandle
 * -----------------------------------------------------------------------------
 * ハンドル ID 文字列から「左右どちらのハンドルか」を判定する。
 *
 * 判定基準:
 * - "hL-" で始まる → "L"
 * - 上記以外       → "R"
 *
 * 用途:
 * - Edge 描画やドラッグ時に、接続方向を制御するために利用。
 * - 例: 左側(L)は入力、右側(R)は出力といった制約を掛けられる。
 *
 * 注意:
 * - デフォルトで "hR-" 以外の未知プレフィックスも "R" と解釈するため、
 *   将来プレフィックス仕様を追加する場合はこのロジックを拡張する必要がある。
 */
export const sideFromHandle = (h: string): "L" | "R" =>
  (h.startsWith("hL-") ? "L" : "R");
